{{ define "main" }}
<!-- Archives -->
<section class="section content main-load">
    <div class="container">
        <article class="post_article archives" itemscope itemtype="https://schema.org/Article">
            {{- $posts := where .Site.RegularPages "Type" "in" .Site.Params.mainSections }}
            {{- $postsByYear := dict }}
            {{- $years := slice }}

            {{- range $posts }}
                {{- $year := .Date.Format "2006" }}
                {{- $yearPosts := index $postsByYear $year }}
                {{- if not $yearPosts }}
                    {{- $yearPosts = slice }}
                    {{- $years = $years | append $year }}
                {{- end }}
                {{- $yearPosts = $yearPosts | append . }}
                {{- $postsByYear = merge $postsByYear (dict $year $yearPosts) }}
            {{- end }}

            {{- $sortedYears := sort $years "value" "desc" }}
            {{- range $sortedYears }}
                {{- $year := . }}
                {{- $yearPosts := index $postsByYear $year }}
                {{- $sortedPosts := sort $yearPosts "Date" "desc" }}
                <h3>{{ $year }}</h3>
                <table>
                    {{- range $sortedPosts }}
                    <tr>
                        <td width="80" style="text-align:right;">{{ .Date.Format "01-02" }}</td>
                        <td>
                            <a href="{{ .RelPermalink }}">{{ .Title }}</a>
                        </td>
                        {{- if $.Site.Params.comments }}
                        <td width="80" style="text-align:right; color: #AAB2BD;">
                            {{ partial "comment-count.html" . }} 评论
                        </td>
                        {{- end }}
                    </tr>
                    {{- end }}
                </table>
            {{- end }}

            {{- if eq (len $posts) 0 }}
            <p style="text-align: center; padding: 2rem; color: #AAB2BD;">
                暂无文章
            </p>
            {{- end }}
        </article>
    </div>
</section>
{{ end }}
